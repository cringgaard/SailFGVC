loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\PIL\Image.py:959: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  warnings.warn(
Using custom data configuration default
Reusing dataset boats_dataset (C:\Users\chris\.cache\huggingface\datasets\cringgaard___boats_dataset\default\0.0.0\3ecf803a5d69bc502fa23944113d613c2d8c3c87f65fed52fa265f5155cff374)
loading configuration file preprocessor_config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\preprocessor_config.json
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
size should be a dictionary on of the following set of keys: ({'width', 'height'}, {'shortest_edge'}, {'shortest_edge', 'longest_edge'}), got 224. Converted to {'height': 224, 'width': 224}.
Image processor ViTImageProcessor {
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
Using custom data configuration default
Reusing dataset boats_dataset (C:\Users\chris\.cache\huggingface\datasets\cringgaard___boats_dataset\default\0.0.0\3ecf803a5d69bc502fa23944113d613c2d8c3c87f65fed52fa265f5155cff374)
loading configuration file preprocessor_config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\preprocessor_config.json
Using custom data configuration default
Reusing dataset boats_dataset (C:\Users\chris\.cache\huggingface\datasets\cringgaard___boats_dataset\default\0.0.0\3ecf803a5d69bc502fa23944113d613c2d8c3c87f65fed52fa265f5155cff374)
loading configuration file preprocessor_config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\preprocessor_config.json
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
size should be a dictionary on of the following set of keys: ({'width', 'height'}, {'shortest_edge'}, {'shortest_edge', 'longest_edge'}), got 224. Converted to {'height': 224, 'width': 224}.
Image processor ViTImageProcessor {
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
Using custom data configuration default
Reusing dataset boats_dataset (C:\Users\chris\.cache\huggingface\datasets\cringgaard___boats_dataset\default\0.0.0\3ecf803a5d69bc502fa23944113d613c2d8c3c87f65fed52fa265f5155cff374)
loading configuration file preprocessor_config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\preprocessor_config.json
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
size should be a dictionary on of the following set of keys: ({'width', 'height'}, {'shortest_edge'}, {'shortest_edge', 'longest_edge'}), got 224. Converted to {'height': 224, 'width': 224}.
Image processor ViTImageProcessor {
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
Using custom data configuration default
Reusing dataset boats_dataset (C:\Users\chris\.cache\huggingface\datasets\cringgaard___boats_dataset\default\0.0.0\3ecf803a5d69bc502fa23944113d613c2d8c3c87f65fed52fa265f5155cff374)
loading configuration file preprocessor_config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\preprocessor_config.json
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
size should be a dictionary on of the following set of keys: ({'width', 'height'}, {'shortest_edge'}, {'shortest_edge', 'longest_edge'}), got 224. Converted to {'height': 224, 'width': 224}.
Image processor ViTImageProcessor {
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 8324
  Num Epochs = 3
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 390
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\PIL\Image.py:959: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  warnings.warn(
{'loss': 4.1978, 'learning_rate': 1.282051282051282e-05, 'epoch': 0.08}
{'loss': 4.1243, 'learning_rate': 2.564102564102564e-05, 'epoch': 0.15}
{'loss': 3.9109, 'learning_rate': 3.846153846153846e-05, 'epoch': 0.23}
{'loss': 3.6382, 'learning_rate': 4.985754985754986e-05, 'epoch': 0.31}
{'loss': 3.4755, 'learning_rate': 4.8433048433048433e-05, 'epoch': 0.38}
{'loss': 3.3651, 'learning_rate': 4.700854700854701e-05, 'epoch': 0.46}
{'loss': 3.3165, 'learning_rate': 4.558404558404559e-05, 'epoch': 0.54}
{'loss': 3.2577, 'learning_rate': 4.415954415954416e-05, 'epoch': 0.61}
{'loss': 3.2012, 'learning_rate': 4.2735042735042735e-05, 'epoch': 0.69}
{'loss': 3.1812, 'learning_rate': 4.131054131054131e-05, 'epoch': 0.77}
{'loss': 3.1151, 'learning_rate': 3.988603988603989e-05, 'epoch': 0.84}
{'loss': 3.0762, 'learning_rate': 3.846153846153846e-05, 'epoch': 0.92}
***** Running Evaluation *****
  Num examples = 2080
  Batch size = 16
{'loss': 3.0839, 'learning_rate': 3.7037037037037037e-05, 'epoch': 1.0}
Saving model checkpoint to models/first_model\checkpoint-130
Configuration saved in models/first_model\checkpoint-130\config.json
Model weights saved in models/first_model\checkpoint-130\pytorch_model.bin
Image processor saved in models/first_model\checkpoint-130\preprocessor_config.json
{'eval_loss': 3.0257012844085693, 'eval_accuracy': 0.23846153846153847, 'eval_runtime': 31.6715, 'eval_samples_per_second': 65.674, 'eval_steps_per_second': 4.105, 'epoch': 1.0}
{'loss': 3.1047, 'learning_rate': 3.561253561253561e-05, 'epoch': 1.08}
{'loss': 2.959, 'learning_rate': 3.418803418803419e-05, 'epoch': 1.15}
{'loss': 2.9489, 'learning_rate': 3.2763532763532764e-05, 'epoch': 1.23}
{'loss': 2.9305, 'learning_rate': 3.133903133903134e-05, 'epoch': 1.31}
{'loss': 2.9365, 'learning_rate': 2.9914529914529915e-05, 'epoch': 1.38}
{'loss': 2.8074, 'learning_rate': 2.8490028490028492e-05, 'epoch': 1.46}
{'loss': 2.9692, 'learning_rate': 2.706552706552707e-05, 'epoch': 1.54}
{'loss': 2.7896, 'learning_rate': 2.564102564102564e-05, 'epoch': 1.61}
{'loss': 2.8302, 'learning_rate': 2.4216524216524217e-05, 'epoch': 1.69}
{'loss': 2.8315, 'learning_rate': 2.2792022792022794e-05, 'epoch': 1.77}
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\PIL\Image.py:959: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  warnings.warn(
{'loss': 2.8051, 'learning_rate': 2.1367521367521368e-05, 'epoch': 1.84}
{'loss': 2.8707, 'learning_rate': 1.9943019943019945e-05, 'epoch': 1.92}
{'loss': 2.8248, 'learning_rate': 1.8518518518518518e-05, 'epoch': 2.0}
***** Running Evaluation *****
  Num examples = 2080
  Batch size = 16
Saving model checkpoint to models/first_model\checkpoint-260
Configuration saved in models/first_model\checkpoint-260\config.json
Model weights saved in models/first_model\checkpoint-260\pytorch_model.bin
Image processor saved in models/first_model\checkpoint-260\preprocessor_config.json
{'eval_loss': 2.7710273265838623, 'eval_accuracy': 0.28557692307692306, 'eval_runtime': 28.4883, 'eval_samples_per_second': 73.013, 'eval_steps_per_second': 4.563, 'epoch': 2.0}
{'loss': 2.8487, 'learning_rate': 1.7094017094017095e-05, 'epoch': 2.08}
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\PIL\Image.py:959: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  warnings.warn(
{'loss': 2.7487, 'learning_rate': 1.566951566951567e-05, 'epoch': 2.15}
{'loss': 2.7203, 'learning_rate': 1.4245014245014246e-05, 'epoch': 2.23}
{'loss': 2.7806, 'learning_rate': 1.282051282051282e-05, 'epoch': 2.31}
{'loss': 2.7087, 'learning_rate': 1.1396011396011397e-05, 'epoch': 2.38}
{'loss': 2.7478, 'learning_rate': 9.971509971509972e-06, 'epoch': 2.46}
{'loss': 2.7217, 'learning_rate': 8.547008547008548e-06, 'epoch': 2.54}
{'loss': 2.7004, 'learning_rate': 7.122507122507123e-06, 'epoch': 2.61}
{'loss': 2.6922, 'learning_rate': 5.6980056980056985e-06, 'epoch': 2.69}
{'loss': 2.6925, 'learning_rate': 4.273504273504274e-06, 'epoch': 2.77}
{'loss': 2.6335, 'learning_rate': 2.8490028490028492e-06, 'epoch': 2.84}
{'loss': 2.7196, 'learning_rate': 1.4245014245014246e-06, 'epoch': 2.92}
{'loss': 2.686, 'learning_rate': 0.0, 'epoch': 3.0}
***** Running Evaluation *****
  Num examples = 2080
  Batch size = 16
{'eval_loss': 2.7069714069366455, 'eval_accuracy': 0.3014423076923077, 'eval_runtime': 35.5165, 'eval_samples_per_second': 58.564, 'eval_steps_per_second': 3.66, 'epoch': 3.0}
Saving model checkpoint to models/first_model\checkpoint-390
Configuration saved in models/first_model\checkpoint-390\config.json
Model weights saved in models/first_model\checkpoint-390\pytorch_model.bin
Image processor saved in models/first_model\checkpoint-390\preprocessor_config.json
Training completed. Do not forget to share your model on huggingface.co/models =)
Loading best model from models/first_model\checkpoint-390 (score: 0.3014423076923077).
{'train_runtime': 1011.1729, 'train_samples_per_second': 24.696, 'train_steps_per_second': 0.386, 'train_loss': 3.024414174984663, 'epoch': 3.0}
Using custom data configuration default
Reusing dataset boats_dataset (C:\Users\chris\.cache\huggingface\datasets\cringgaard___boats_dataset\default\0.0.0\3ecf803a5d69bc502fa23944113d613c2d8c3c87f65fed52fa265f5155cff374)
loading configuration file preprocessor_config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\preprocessor_config.json
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
size should be a dictionary on of the following set of keys: ({'width', 'height'}, {'shortest_edge'}, {'shortest_edge', 'longest_edge'}), got 224. Converted to {'height': 224, 'width': 224}.
Image processor ViTImageProcessor {
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}
None
['img', 'Hull Type', 'Rigging Type', 'Construction', 'Ballast Type', 'Designer', 'name']
['Hull Type', 'Rigging Type', 'Construction', 'Ballast Type', 'Designer', 'name']
['Hull Type', 'Rigging Type', 'Construction', 'Ballast Type', 'Designer', 'name']
None
['Hull Type', 'Rigging Type', 'Construction', 'Ballast Type', 'Designer', 'name']
['Hull Type', 'Rigging Type', 'Construction', 'Ballast Type', 'Designer', 'name']
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 8324
  Num Epochs = 1
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 130
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
Using custom data configuration default
Reusing dataset boats_dataset (C:\Users\chris\.cache\huggingface\datasets\cringgaard___boats_dataset\default\0.0.0\3ecf803a5d69bc502fa23944113d613c2d8c3c87f65fed52fa265f5155cff374)
loading configuration file preprocessor_config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\preprocessor_config.json
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
size should be a dictionary on of the following set of keys: ({'width', 'height'}, {'shortest_edge'}, {'shortest_edge', 'longest_edge'}), got 224. Converted to {'height': 224, 'width': 224}.
Image processor ViTImageProcessor {
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 8324
  Num Epochs = 1
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 130
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 8324
  Num Epochs = 1
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 130
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
DatasetDict({
    train: Dataset({
        features: ['img', 'Hull Type'],
        num_rows: 8324
    })
    test: Dataset({
        features: ['img', 'Hull Type'],
        num_rows: 2080
    })
})
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\transformers\optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 8324
  Num Epochs = 1
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 130
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
Using custom data configuration default
Reusing dataset boats_dataset (C:\Users\chris\.cache\huggingface\datasets\cringgaard___boats_dataset\default\0.0.0\3ecf803a5d69bc502fa23944113d613c2d8c3c87f65fed52fa265f5155cff374)
loading configuration file preprocessor_config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\preprocessor_config.json
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
size should be a dictionary on of the following set of keys: ({'width', 'height'}, {'shortest_edge'}, {'shortest_edge', 'longest_edge'}), got 224. Converted to {'height': 224, 'width': 224}.
Image processor ViTImageProcessor {
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.5,
    0.5,
    0.5
  ],
  "image_processor_type": "ViTImageProcessor",
  "image_std": [
    0.5,
    0.5,
    0.5
  ],
  "resample": 2,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "height": 224,
    "width": 224
  }
}
loading configuration file config.json from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\config.json
Model config ViTConfig {
  "_name_or_path": "google/vit-base-patch16-224-in21k",
  "architectures": [
    "ViTModel"
  ],
  "attention_probs_dropout_prob": 0.0,
  "encoder_stride": 16,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.0,
  "hidden_size": 768,
  "id2label": {
    "0": "catamaran (no boards/asym.)",
    "1": "catamaran single cntrboard",
    "10": "centerboard dinghy",
    "11": "daggerboard",
    "12": "dbrd. dinghy",
    "13": "double-ended with leeboards",
    "14": "double-ended with long keel",
    "15": "fin (shoal draft)",
    "16": "fin keel",
    "17": "fin keel w/bulb",
    "18": "fin w/bulb & dual rudders",
    "19": "fin w/bulb & spade rudder",
    "2": "catamaran single dbrd",
    "20": "fin w/bulb and transom hung rudder",
    "21": "fin w/dual rudders",
    "22": "fin w/rudder on partial skeg",
    "23": "fin w/spade rudder",
    "24": "fin w/transom hung rudder",
    "25": "fin with rudder on skeg",
    "26": "foiling monohull",
    "27": "foiling trimaran",
    "28": "full keel",
    "29": "full keel with attached rudder",
    "3": "catamaran twin cbrd",
    "30": "iceboat (bow steerer)",
    "31": "keel/cb & spade rudder",
    "32": "keel/cb w/dual rudders",
    "33": "keel/cb w/rudder on skeg",
    "34": "keel/cbrd",
    "35": "leeboard",
    "36": "lifting keel",
    "37": "\"lifting keel w/bulb, trans. hung rudder\"",
    "38": "lifting keel w/bulb; spade rudder",
    "39": "lifting keel with dual rudders",
    "4": "catamaran twin dbrd",
    "40": "long keel",
    "41": "long keel w/rudder on skeg",
    "42": "long keel w/trans. hung rudder",
    "43": "long keel w/two centerboards",
    "44": "modified full keel",
    "45": "pram (centerboard)",
    "46": "pram (daggerboard)",
    "47": "pram (leeboard)",
    "48": "scow sngl. cbrd",
    "49": "scow twin cbrd",
    "5": "catamaran twin keel",
    "50": "sheel keel",
    "51": "swing keel",
    "52": "swing keel w/dual rudders",
    "53": "swing keel w/outboard rudder",
    "54": "tandem keel",
    "55": "tandem keel w/spade rudder",
    "56": "trimaran cbrd",
    "57": "trimaran dbrd",
    "58": "trimaran with fixed unballasted keel",
    "59": "triple keel",
    "6": "catamaran w/foils",
    "60": "twin centerboards",
    "61": "twin daggerboards",
    "62": "twin drop plates",
    "63": "twin keel",
    "64": "twin keels with dual rudders",
    "65": "wing keel",
    "66": "wing keel w/spade rudder",
    "7": "cbrd (trunk) w/dual rudders",
    "8": "cbrd w/outboard rudder",
    "9": "centerboard (trunk)"
  },
  "image_size": 224,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "\"lifting keel w/bulb, trans. hung rudder\"": "37",
    "catamaran (no boards/asym.)": "0",
    "catamaran single cntrboard": "1",
    "catamaran single dbrd": "2",
    "catamaran twin cbrd": "3",
    "catamaran twin dbrd": "4",
    "catamaran twin keel": "5",
    "catamaran w/foils": "6",
    "cbrd (trunk) w/dual rudders": "7",
    "cbrd w/outboard rudder": "8",
    "centerboard (trunk)": "9",
    "centerboard dinghy": "10",
    "daggerboard": "11",
    "dbrd. dinghy": "12",
    "double-ended with leeboards": "13",
    "double-ended with long keel": "14",
    "fin (shoal draft)": "15",
    "fin keel": "16",
    "fin keel w/bulb": "17",
    "fin w/bulb & dual rudders": "18",
    "fin w/bulb & spade rudder": "19",
    "fin w/bulb and transom hung rudder": "20",
    "fin w/dual rudders": "21",
    "fin w/rudder on partial skeg": "22",
    "fin w/spade rudder": "23",
    "fin w/transom hung rudder": "24",
    "fin with rudder on skeg": "25",
    "foiling monohull": "26",
    "foiling trimaran": "27",
    "full keel": "28",
    "full keel with attached rudder": "29",
    "iceboat (bow steerer)": "30",
    "keel/cb & spade rudder": "31",
    "keel/cb w/dual rudders": "32",
    "keel/cb w/rudder on skeg": "33",
    "keel/cbrd": "34",
    "leeboard": "35",
    "lifting keel": "36",
    "lifting keel w/bulb; spade rudder": "38",
    "lifting keel with dual rudders": "39",
    "long keel": "40",
    "long keel w/rudder on skeg": "41",
    "long keel w/trans. hung rudder": "42",
    "long keel w/two centerboards": "43",
    "modified full keel": "44",
    "pram (centerboard)": "45",
    "pram (daggerboard)": "46",
    "pram (leeboard)": "47",
    "scow sngl. cbrd": "48",
    "scow twin cbrd": "49",
    "sheel keel": "50",
    "swing keel": "51",
    "swing keel w/dual rudders": "52",
    "swing keel w/outboard rudder": "53",
    "tandem keel": "54",
    "tandem keel w/spade rudder": "55",
    "trimaran cbrd": "56",
    "trimaran dbrd": "57",
    "trimaran with fixed unballasted keel": "58",
    "triple keel": "59",
    "twin centerboards": "60",
    "twin daggerboards": "61",
    "twin drop plates": "62",
    "twin keel": "63",
    "twin keels with dual rudders": "64",
    "wing keel": "65",
    "wing keel w/spade rudder": "66"
  },
  "layer_norm_eps": 1e-12,
  "model_type": "vit",
  "num_attention_heads": 12,
  "num_channels": 3,
  "num_hidden_layers": 12,
  "patch_size": 16,
  "qkv_bias": true,
  "transformers_version": "4.26.1"
}
loading weights file pytorch_model.bin from cache at C:\Users\chris/.cache\huggingface\hub\models--google--vit-base-patch16-224-in21k\snapshots\7cbdb7ee3a6bcdf99dae654893f66519c480a0f8\pytorch_model.bin
DatasetDict({
    train: Dataset({
        features: ['img', 'Hull Type'],
        num_rows: 8324
    })
    test: Dataset({
        features: ['img', 'Hull Type'],
        num_rows: 2080
    })
})
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.weight', 'pooler.dense.bias']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
PyTorch: setting up devices
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
***** Running training *****
  Num examples = 8324
  Num Epochs = 1
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 64
  Gradient Accumulation steps = 4
  Total optimization steps = 130
  Number of trainable parameters = 85850179
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
c:\Users\chris\AppData\Local\Programs\Python\Python310\lib\site-packages\PIL\Image.py:959: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
